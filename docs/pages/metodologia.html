<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metodologia - Infer√™ncia Geoespacial</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1 class="header-title">
                <span class="icon icon-map"></span>
                Infer√™ncia Geoespacial Aplicada √† Gera√ß√£o de Base Vetorial Rodovi√°ria: Estudo de Caso para o Estado de S√£o Paulo
            </h1>
            <p class="header-subtitle">Base estimada: Malha municipal estimada - PLI/SP (OSM + DER/SP + SEADE)</p>
        </div>
    </header>

    <nav class="nav">
        <div class="nav-container">
            <ul class="nav-list">
                <li class="nav-item"><a href="../index.html" class="nav-link">In√≠cio</a></li>
                <li class="nav-item"><a href="dados.html" class="nav-link">Dados</a></li>
                <li class="nav-item"><a href="metodologia.html" class="nav-link active">Metodologia</a></li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Resultados</a>
                    <ul class="dropdown-menu">
                        <li><a href="resultados-municipal.html" class="dropdown-link">An√°lise Municipal</a></li>
                        <li><a href="resultados-regional.html" class="dropdown-link">An√°lise Regional</a></li>
                    </ul>
                </li>
                <li class="nav-item"><a href="conclusao.html" class="nav-link">Conclus√£o</a></li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Anexos</a>
                    <ul class="dropdown-menu">
                        <li><a href="mapa-fullscreen.html" class="dropdown-link">Mapas</a></li>
                        <li><a href="pesquisa-municipal.html" class="dropdown-link">Pesquisa Municipal</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>

    <main class="main-content">
        <h1 class="page-title">Metodologia</h1>
        <p class="page-subtitle">Fluxo t√©cnico para estimar a malha vicinal paulista com rastreabilidade e justificativas</p>

        <section class="section">
            <h2 class="section-title">Procedimentos Metodol√≥gicos</h2>
            <div class="section-content">
                <p>
                    Diante da inex ist√™ncia de base oficial unificada, este estudo adota uma estrat√©gia de integra√ß√£o de fontes abertas e oficiais para estimar a malha vicinal paulista. A base principal prov√©m do OpenStreetMap (OSM), plataforma colaborativa de mapeamento global que registra vias de todas as hierarquias a partir de contribui√ß√µes volunt√°rias, imagens de sat√©lite e levantamentos de campo. Para reduzir ru√≠do urbano e garantir ader√™ncia ao conceito de malha vicinal, aplicam-se filtros espaciais baseados em √°reas urbanizadas (IBGE, 2019), faces de logradouro (Censo 2022) e buffers de sobreposi√ß√£o com a rede estadual (DER/SP). O processamento resulta em uma base geoespacial consistente, com cobertura estadual e recorte municipal, que permite compara√ß√µes diretas entre os 645 munic√≠pios paulistas.
                </p>
                <p>
                    A abordagem metodol√≥gica prioriza reprodutibilidade, rastreabilidade de decis√µes t√©cnicas e documenta√ß√£o integral do fluxo de processamento. Todos os dados de entrada s√£o p√∫blicos, as ferramentas utilizadas s√£o de c√≥digo aberto e os crit√©rios de filtragem est√£o explicitados em detalhes nas se√ß√µes subsequentes. Essa transpar√™ncia assegura auditabilidade t√©cnica e permite replica√ß√£o ou adapta√ß√£o do estudo para outros contextos territoriais.
                </p>
                
                <h3>Princ√≠pios Norteadores</h3>
                <p>Adotamos um desenho metodol√≥gico replic√°vel, guiado por princ√≠pios de ci√™ncia de dados espaciais: <strong>completude</strong> (maximizar cobertura territorial), <strong>especificidade</strong> (excluir ru√≠do urbano e duplicidades), <strong>rastreabilidade</strong> (par√¢metros expl√≠citos e versionados) e <strong>auditabilidade</strong> (passo a passo documentado). Cada decis√£o t√©cnica visa minimizar vi√©s de superestima√ß√£o (inclus√£o de vias urbanas) ou subestima√ß√£o (exclus√£o indevida por buffers).</p>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Arquitetura Metodol√≥gica</h2>
            <div class="cards-grid">
                <div class="card">
                    <h4 class="card-title">Princ√≠pios</h4>
                    <div class="card-content">
                        <ul class="list-tight">
                            <li>Reprodutibilidade: scripts versionados e par√¢metros declarados.</li>
                            <li>Conservadorismo espacial: remover sobreposi√ß√µes urbanas e rodovias estaduais.</li>
                            <li>Comparabilidade: m√©tricas homog√™neas por munic√≠pio e RA.</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <h4 class="card-title">Entradas</h4>
                    <div class="card-content">
                        <ul class="list-tight">
                            <li>OSM (Sudeste, nov/2025) ‚Äî malha vi√°ria completa.</li>
                            <li>DER/SP (mai/2025) ‚Äî cadastro oficial estadual.</li>
                            <li>IBGE 2019 (√°reas urbanas) e Faces 2022 ‚Äî exclus√£o urbana fina.</li>
                            <li>SEADE ‚Äî limites municipais e RAs.</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <h4 class="card-title">Sa√≠das</h4>
                    <div class="card-content">
                        <ul class="list-tight">
                            <li>Segmentos OSM filtrados (GeoPackage).</li>
                            <li>Agregados municipais e por RA (tabelas comparativas).</li>
                            <li>Indicadores de densidade e raz√£o OSM/DER.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Passo a Passo Detalhado</h2>
            <div class="section-content">
                <h3 class="section-subtitle">1) Prepara√ß√£o e harmoniza√ß√£o</h3>
                <p>
                    Os dados da base OSM foram recortados para o limite administrativo do Estado de S√£o Paulo, utilizando como refer√™ncia espacial o sistema SIRGAS 2000 / UTM 23S. Esse procedimento garante extens√£o compat√≠vel com os limites oficiais estaduais e reduz significativamente o volume computacional nas etapas subsequentes. Em seguida, os dados foram enriquecidos com informa√ß√µes das bases da Funda√ß√£o SEADE, agregando os atributos <em>Cod_ibge</em> (c√≥digo do munic√≠pio) e <em>GID_RA</em> (identificador da Regi√£o Administrativa). Esse enriquecimento √© fundamental para permitir an√°lises multiescala, possibilitando tanto caracteriza√ß√µes municipais quanto agrega√ß√µes regionais.
                </p>

                <!-- CARD CRS -->
                <div class="card" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); color: white; border: none; margin: 1.5rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <div class="card-content" style="color: white;">
                        <h4 class="card-title" style="color: white; display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.5rem;">üó∫Ô∏è</span>
                            Sistema de Refer√™ncia Espacial (CRS) Oficial
                        </h4>
                        <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 0.5rem; color: white;">
                            <p style="margin: 0 0 0.75rem 0; font-size: 1.05rem; color: white;"><strong style="color: white;">SIRGAS 2000 / UTM Zone 23S (EPSG:31983)</strong></p>
                            <ul style="margin: 0; padding-left: 1.5rem; list-style-type: none; color: white;">
                                <li style="margin: 0.5rem 0; color: white;">‚úì <strong style="color: white;">Proje√ß√£o oficial:</strong> Sistema de coordenadas projetadas adotado como padr√£o para o Estado de S√£o Paulo</li>
                                <li style="margin: 0.5rem 0; color: white;">‚úì <strong style="color: white;">Compatibiliza√ß√£o:</strong> Todas as bases espaciais (OSM, DER/SP, IBGE, SEADE) foram reprojetadas para EPSG:31983</li>
                                <li style="margin: 0.5rem 0; color: white;">‚úì <strong style="color: white;">C√°lculos m√©tricos:</strong> Todas as medi√ß√µes de √°rea (km¬≤) e comprimento (km) utilizaram geometrias em UTM 23S</li>
                                <li style="margin: 0.5rem 0; color: white;">‚úì <strong style="color: white;">Precis√£o:</strong> Proje√ß√£o UTM garante distor√ß√£o inferior a 1% dentro da zona, adequada para an√°lises em escala estadual</li>
                            </ul>
                            <p style="margin: 0.75rem 0 0 0; padding-top: 0.75rem; border-top: 1px solid rgba(255,255,255,0.2); font-size: 0.95rem; color: white;">
                                <strong style="color: white;">Nota t√©cnica:</strong> Embora S√£o Paulo se estenda pelos fusos UTM 22S (oeste) e 23S (leste), adotou-se o fuso 23S por ser o padr√£o oficial do IBGE, SEADE e DER/SP, garantindo compatibilidade com bases oficiais e consist√™ncia nas an√°lises territoriais.
                            </p>
                        </div>
                    </div>
                </div>

                <h3 class="section-subtitle">2) Filtragem de ru√≠do urbano</h3>
                <p>
                    Para remover vias urbanas que n√£o caracterizam a malha vicinal, foram aplicados dois filtros espaciais complementares. Primeiro, realizou-se uma intersec√ß√£o com a camada de Faces de Logradouro do IBGE (Censo 2022), utilizando um buffer de 10 metros. Esse procedimento remove vias intraquadra (ruas locais) e evita superestima√ß√£o causada pelo mapeamento denso caracter√≠stico de √°reas urbanas no OpenStreetMap. Em seguida, aplicou-se uma segunda intersec√ß√£o com a camada de √Åreas Urbanizadas do IBGE (2019), assegurando o alinhamento com os per√≠metros urbanos oficialmente delimitados. Essa estrat√©gia dupla reduz o vi√©s metropolitano e garante que apenas vias com caracter√≠sticas rurais ou de acesso sejam mantidas na base.
                </p>

                <h3 class="section-subtitle">3) Subtra√ß√£o da rede estadual</h3>
                <p>
                    Para evitar duplicidade entre a malha estadual (DER/SP) e a malha vicinal estimada, aplicou-se um buffer de 60 a 100 metros sobre os eixos rodovi√°rios estaduais cadastrados. Essas margens ampliadas foram dimensionadas para absorver imprecis√µes de alinhamento geom√©trico entre as bases OSM e DER/SP, al√©m de evitar a inclus√£o de vicinais estritamente paralelas √†s rodovias estaduais. Todas as vias OSM que interceptam essa m√°scara de exclus√£o foram descartadas, garantindo que a malha resultante seja composta exclusivamente por rodovias municipais e estradas vicinais, sem sobreposi√ß√£o com a rede de responsabilidade estadual.
                </p>

                <h3 class="section-subtitle">4) Sele√ß√£o final de vicinais</h3>
                <p>
                    Ap√≥s as etapas de filtragem espacial, aplicaram-se crit√©rios l√≥gicos finais para sele√ß√£o dos segmentos que comp√µem a malha vicinal estimada. O primeiro crit√©rio exclui todos os segmentos marcados com <code>area_urb = 1</code>, eliminando vias remanescentes em √°reas urbanas que possam inflar artificialmente a extens√£o da malha. O segundo crit√©rio remove segmentos com <code>path IS NOT NULL</code>, retirando vias censit√°rias urbanas que eventualmente n√£o foram capturadas pelos filtros espaciais anteriores. Por fim, o terceiro crit√©rio descarta segmentos com <code>malha_der = 1</code>, removendo qualquer sobreposi√ß√£o residual com a rede estadual. A aplica√ß√£o conjunta desses tr√™s crit√©rios resulta em uma base final refinada, com alta especificidade para caracteriza√ß√£o da malha vicinal paulista.
                </p>
                <div class="table-container mt-1">
                    <table>
                        <thead>
                            <tr>
                                <th>Crit√©rio</th>
                                <th>Condi√ß√£o</th>
                                <th>Por que aplicar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Exclus√£o urbana</td>
                                <td><code>area_urb = 0</code></td>
                                <td>Evita inflar malha com ruas locais.</td>
                            </tr>
                            <tr>
                                <td>Exclus√£o logradouro</td>
                                <td><code>path IS NULL</code></td>
                                <td>Retira vias censit√°rias urbanas remanescentes.</td>
                            </tr>
                            <tr>
                                <td>Exclus√£o DER</td>
                                <td><code>malha_der = 0</code></td>
                                <td>Remove sobreposi√ß√µes com a rede estadual.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Insumos e Consolida√ß√£o</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Dataset</th>
                            <th>Fonte</th>
                            <th>Features</th>
                            <th>Uso</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>OSM Sudeste</strong></td>
                            <td>Geofabrik (Nov/2025)</td>
                            <td>1.358.788 ways (SP)</td>
                            <td>Base de vias</td>
                        </tr>
                        <tr>
                            <td><strong>√Åreas Urbanas</strong></td>
                            <td>IBGE 2019</td>
                            <td>16.042 pol√≠gonos</td>
                            <td>Exclus√£o urbana</td>
                        </tr>
                        <tr>
                            <td><strong>Faces Logradouro</strong></td>
                            <td>IBGE Censo 2022</td>
                            <td>~2,4 milh√µes (SP)</td>
                            <td>Exclus√£o vias censit√°rias</td>
                        </tr>
                        <tr>
                            <td><strong>Malha DER</strong></td>
                            <td>DER/SP (Mai/2025)</td>
                            <td>7.417 segmentos</td>
                            <td>Subtra√ß√£o da rede estadual</td>
                        </tr>
                        <tr>
                            <td><strong>Munic√≠pios SEADE</strong></td>
                            <td>Funda√ß√£o SEADE</td>
                            <td>645 pol√≠gonos</td>
                            <td>Agrega√ß√£o municipal/RA</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Sequenciamento Operacional</h2>
            <h3 class="section-subtitle">Arquivos de execu√ß√£o (QGIS + R)</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Arquivo</th>
                            <th>Descri√ß√£o</th>
                            <th>Features</th>
                            <th>Novos atributos</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>_01_SP_OSM.shp</code></td>
                            <td>Clip OSM + atributos municipais/RA</td>
                            <td>1.358.788</td>
                            <td>Cod_ibge, GID_RA</td>
                        </tr>
                        <tr>
                            <td><code>_02_FL_SP_OSM.shp</code></td>
                            <td>Intersect faces logradouro</td>
                            <td>1.205.819</td>
                            <td>path</td>
                        </tr>
                        <tr>
                            <td><code>_03_AU_FL_SP_OSM.shp</code></td>
                            <td>Intersect √°reas urbanas</td>
                            <td>1.319.976</td>
                            <td>area_urb</td>
                        </tr>
                        <tr>
                            <td><code>_04_DER_AU_FL_SP_OSM.shp</code></td>
                            <td>Intersect buffer DER (60‚Äì100 m)</td>
                            <td>1.390.882</td>
                            <td>malha_der</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="alert alert-warning mt-2">
                <strong>Nota:</strong> contagem aumenta ap√≥s intersec√ß√µes devido √† fragmenta√ß√£o de segmentos, efeito esperado e controlado na agrega√ß√£o.</div>
        </section>

        <section class="section">
            <h2 class="section-title">Agrega√ß√£o e Compara√ß√£o</h2>
            <div class="section-content">
                <p><strong>Arquivo:</strong> <code>_05_SumarizacaoSHP.R</code></p>
                <pre><code>library(sp)
library(rgdal)
library(dplyr)
library(writexl)

# Leitura
SHPMUN <- readShapePoly("LimiteMunicipal_SEADE.shp")
SHPDER <- readShapePoly("Rodovias_municipais_wgsutm23s_intesect_mun.shp")
SHPOSM <- readShapePoly("_04_DER_AU_FL_SP_OSM_wgs84Utm23s.shp")

# Filtro vicinais: fora de √°rea urbana e fora do buffer DER
OSM_vicinais <- subset(SHPOSM, area_urb == 0 & malha_der == 0)

# Agrega√ß√£o por munic√≠pio
DER_resumo <- SHPDER %>%
  group_by(Cod_ibge) %>%
  summarise(Vic_DER_metros = sum(metros, na.rm = TRUE),
            Vic_DER_qtde   = n())

OSM_resumo <- OSM_vicinais %>%
  group_by(Cod_ibge) %>%
  summarise(Vic_OSM_metros = sum(metros, na.rm = TRUE),
            Vic_OSM_qtde   = n())

# Join com base municipal
resultado <- SHPMUN %>%
  left_join(DER_resumo,  by = "Cod_ibge") %>%
  left_join(OSM_resumo,  by = "Cod_ibge")

# Exporta√ß√£o
write_xlsx(resultado, "_06_Comparacao_DER_vs_OSM.xlsx")</code></pre>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Robustez e Limita√ß√µes</h2>
            <div class="cards-grid">
                <div class="card">
                    <h4 class="card-title">Robustez</h4>
                    <div class="card-content">
                        <ul class="list-tight">
                            <li>Filtros urbanos multiescala (IBGE 2019 + Faces 2022).</li>
                            <li>Subtra√ß√£o expl√≠cita da rede estadual.</li>
                            <li>Agrega√ß√£o multiescala (munic√≠pio e RA) com m√©tricas consistentes.</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <h4 class="card-title">Limita√ß√µes</h4>
                    <div class="card-content">
                        <ul class="list-tight">
                            <li>Buffer DER amplo pode excluir vicinais paralelas pr√≥ximas.</li>
                            <li>Fragmenta√ß√£o p√≥s-intersect exige agrega√ß√£o para interpretar extens√£o.</li>
                            <li>Depend√™ncia de qualidade do OSM em √°reas de menor contribui√ß√£o volunt√°ria.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p class="footer-text">Infer√™ncia Geoespacial Aplicada √† Gera√ß√£o de Base Vetorial Rodovi√°ria: Estudo de Caso para o Estado de S√£o Paulo | Janeiro 2026</p>
            <p class="footer-text">Dados: Malha municipal estimada - PLI/SP (OSM + DER/SP + SEADE/IBGE)</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>
